{"version":3,"sources":["../../../src/dragon/models/base.js"],"names":[],"mappings":"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","file":"base.js","sourcesContent":["'use strict';\n\nimport EventEmitter      from '../events'\nimport mixin             from '../mixin'\nimport utils             from '../utils'\n\nclass DragonBaseModel {\n\n  constructor(attr = {}, options = {}) {\n    this.uid = utils.uniqueId(this)\n\n    // TODO: figure out how to mixin this\n    var eventEmitter = new EventEmitter()\n\n    this.emit  = eventEmitter.emitEvent.bind(eventEmitter)\n    this.on    = eventEmitter.addListener.bind(eventEmitter)\n    this.once  = eventEmitter.addOnceListener.bind(eventEmitter)\n    this.off   = eventEmitter.removeListener.bind(eventEmitter)\n\n    this.options = options\n\n    Object.defineProperty(this, 'attr', {\n      configurable: false,\n      enumerable: true,\n      writable: true\n    })\n\n    this.attr = Object.assign({}, this.defaults, attr)\n\n    //this.observeAttributes()\n  }\n\n  /*\n  TODO: not the full appr\n  */\n  clear() {\n\n    this.attr = {}\n    this.emit('change')\n\n  }\n\n  getData() {\n    return Object.assign({}, this.attr)\n  }\n\n  /*\n  TODO: add an an unobserve option\n  */\n  observeAttributes() {\n\n    // Trigger changes on model\n    //Object.observe(this.attr, this.observeHandler.bind(this))\n\n  }\n\n  observeHandler(changes) {\n\n    //this.emit('change', changes)\n\n    /*\n    TODO: consider making this a mixin and expanding to watch specific properties\n    */\n\n    var add    = [],\n        del    = [],\n        update = []\n\n    changes.forEach( (change) => {\n\n      switch(change.type) {\n\n        case 'add'    : add.push(change); break;\n        case 'delete' : del.push(change); break;\n        case 'update' : update.push(change); break;\n\n      }\n\n    })\n\n    if(add.length > 0)    this.emit('add', add)\n    if(del.length > 0)    this.emit('delete', del)\n    if(update.length > 0) this.emit('update', update)\n\n  }\n\n  /*\n  TODO: Undecided on appraoch for sync/fetch/save/etc.\n  */\n  sync() {\n\n  }\n\n  toJSON() {\n\n    return JSON.stringify(this.attr)\n\n  }\n\n  dispose(options = {}) {\n\n    utils.dispose(this, options)\n\n  }\n\n  pairs(object = this.attr) {\n    var index = -1,\n    props = this.keys(object),\n    length = props.length,\n    result = Array(length);\n    while (++index < length) {\n      let key = props[index];\n      result[index] = [key, object[key]];\n    }\n    return result;\n  }\n\n  // Internal pick helper function to determine if `obj` has key `key`.\n  keyInObj(value, key, obj) {\n    return key in obj;\n  }\n\n  // Return a copy of the object only containing the whitelisted properties.\n  pick(...keys) {\n    var obj=this.attr,result = {}, iteratee = keys[0];\n    if (obj == null) return result;\n    if (typeof iteratee === 'function') {\n      if (keys.length > 1) iteratee = iteratee; //TODO optimized callback for enable context\n      keys = this.keys(obj); //not working in inherited properties keys\n    } else {\n      iteratee = this.keyInObj;\n      obj = Object(obj);\n    }\n    for (var i = 0, length = keys.length; i < length; i++) {\n      var key = keys[i];\n      var value = obj[key];\n      if (iteratee(value, key, obj)) result[key] = value;\n    }\n    return result;\n  }\n\n  // Return a copy of the object without the blacklisted properties.\n  omit(...keys) {\n    var obj=this.attr,iteratee = keys[0], context;\n    if (typeof iteratee === 'function') {\n      iteratee = iteratee;\n      if (keys.length > 1) context = keys[1];\n    } else {\n      iteratee = function(value, key, obj) {\n        return keys.indexOf(key) == -1;\n      };\n    }\n    return this.pick(iteratee, context);\n  }\n\n  baseValues(object , props) {\n    var index = -1,\n    length = props.length,\n    result = Array(length);\n\n    while (++index < length) {\n      result[index] = object[props[index]];\n    }\n    return result;\n  }\n\n  values(object = this.attr) {\n    return this.baseValues(object, this.keys(object));\n  }\n\n  keys(object = this.attr){\n    return Object.keys(object);\n  }\n\n  // Invert the keys and values of an object. The values must be serializable.\n  invert(obj = this.attr) {\n    var result = {},\n    index = -1,\n    props = this.keys(obj),\n    length = props.length;\n\n    while (++index < length) {\n      result[obj[props[index]]] = props[index];\n    }\n    return result;\n  }\n\n  isArrayLike(collection) {\n    var length = collection[length];\n    return typeof length == 'number' && length >= 0 && length <= (Math.pow(2, 53) - 1);\n  };\n\n  isEmpty(value = this.attr) {\n    if (value == null) return true;\n    if (isArrayLike(value) && (_.isArray(value) || _.isString(value) || _.isArguments(value))) return value.length === 0;\n    return this.keys(value).length === 0;\n  }\n\n  set(o) {\n    /*Object.defineProperty(this, 'attr', {\n      configurable: false,\n      enumerable: true,\n      writable: true\n    })*/\n\n    var keysChanged = []\n    Object.keys(o).forEach((key) => {\n\n      this.attr[key] = o[key]\n      keysChanged.push(key)\n\n    })\n\n    //this.unobserveAttributes()\n    //this.attr = Object.assign({}, this.attr, o)\n    //this.observeAttributes()\n    this.emit('change', keysChanged)\n  }\n\n  unobserveAttributes() {\n    //delete this.attr\n\n    //Object.unobserve(this.attr, this.observeHandler.bind(this))\n  }\n}\n\n\nDragonBaseModel.prototype.defaults = {}\n\nDragonBaseModel.prototype.disposed = false\n\nDragonBaseModel.prototype.indisposable = false\n\nDragonBaseModel.prototype.url = ''\n\nObject.assign(DragonBaseModel.prototype, {mixin})\n\nexport default DragonBaseModel\n"]}